import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common';
import { IFeatureCardT2 } from '../../../interfaces/ifeature-card-t2';
import { HeaderService } from '../../../services/header.service';
import { ActivatedRoute, ParamMap, Router } from '@angular/router';
import { FeatureCardT2 } from "../../feature-card-t2/feature-card-t2";
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import { TZodiacSign } from '../../../types/tzodiac-sign';
import { ZodiacServices } from '../../../services/zodiac.services';
import { ISvgColors } from '../../../interfaces/isvg-link';
import { ThemeService } from '../../../services/theme.service';
import { NumerologyMenuCard } from "../../menu-card-container/cards/numerology-menu-card/numerology-menu-card";
import { AstrologySection } from "../../astrology-section/astrology-section";
import { AboutSection } from "../../about-section/about-section";
import { FAQSection } from "../../faq-section/faq-section";

export type TSelectedOption = 1 | 3 | 4 | 5;
  // 1 -> One Card Reading
  // 3 -> Three Card Reading
  // 4 -> Major Arcane
  // 5 -> Minor Arcane

@Component({
  selector: 'app-tarot-reading',
  imports: [
    CommonModule,
    FeatureCardT2,
    NumerologyMenuCard,
    AstrologySection,
    AboutSection,
    FAQSection
],
  templateUrl: './tarot-reading.html',
  styleUrl: './tarot-reading.css'
})
export class TarotReading implements OnInit{

  svgColor!: ISvgColors;

  sampleSummary = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";

  summaryCard: IFeatureCardT2 = {
    title: "Summary",
    brief: this.sampleSummary,
    svg: `<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
  <path d="M5.95964 1.08334C4.76867 1.08334 3.79297 2.05905 3.79297 3.25001V22.75C3.79297 23.941 4.76867 24.9167 5.95964 24.9167H20.043C21.2339 24.9167 22.2096 23.941 22.2096 22.75V7.04168H17.8763C16.9854 7.04168 16.2513 6.30756 16.2513 5.41668V1.08334H5.95964ZM17.3346 1.08334V5.41668C17.3346 5.72613 17.5668 5.95834 17.8763 5.95834H21.9113C21.9475 5.92592 17.3346 1.08334 17.3346 1.08334ZM13.6646 10.4461L14.5872 13.0127L17.3167 13.1026C17.8232 13.1203 18.0303 13.7613 17.6298 14.0717L15.4727 15.7422L16.2302 18.3627C16.3718 18.8501 15.8249 19.2469 15.405 18.9615L13.1484 17.4264L10.8875 18.9562C10.4678 19.2397 9.92292 18.8439 10.0634 18.3574L10.8262 15.738L8.67115 14.0622C8.27171 13.7505 8.4809 13.1103 8.98747 13.0942L11.717 13.0095L12.6448 10.444C12.7201 10.2365 12.9139 10.0955 13.1566 10.0967C13.3994 10.0978 13.5907 10.2396 13.6646 10.4461ZM13.1537 12.2245L12.6099 13.7236C12.5346 13.9322 12.3397 14.0739 12.1179 14.0812L10.5226 14.1299L11.7815 15.1096C11.9566 15.2455 12.0312 15.4743 11.9698 15.6872L11.5234 17.217L12.8447 16.3241C13.0284 16.1997 13.2694 16.1997 13.4531 16.3241L14.7723 17.2212L14.329 15.6904C14.2674 15.4769 14.3425 15.2475 14.5184 15.1117L15.7795 14.1352L14.1841 14.0823C13.9623 14.075 13.7674 13.9333 13.6922 13.7247L13.1537 12.2245Z" fill="#FFB114"/>
      </svg>`,
    svgBg: "#FFF1D6",
  };

  selectedOption:TSelectedOption = 3; 
  
  cards: {
    tense?: string;
    title: string;
    brief: string;
    img: string;
  }[] = [
    {
      title: "The Fool",
      brief: this.sampleSummary,
      img: "/images/sample-text.jpg",
      tense: "THE PAST",
    },
    {
      title: "The Fool",
      brief: this.sampleSummary,
      img: "/images/sample-text.jpg",
      tense: "THE PAST",
    },
    {
      title: "The Fool",
      brief: this.sampleSummary,
      img: "/images/sample-text.jpg",
      tense: "THE PAST",
    },
  ];

  readingOptions: {
    id: TSelectedOption;
    name: string;
    svg: string | SafeHtml;
  }[] = [
    {
      id: 1,
      name: "One Card Tarot",
      svg: `<svg xmlns="http://www.w3.org/2000/svg" width="41" height="40" viewBox="0 0 41 40" fill="none">
  <path d="M32.0039 27.2344H31.9648C31.9648 27.2422 31.9648 5.92969 31.9648 5.92969C31.9648 4.66406 30.9336 3.625 29.6602 3.625H14.5586H14.582H12.5195H10.9805C9.70703 3.625 8.67578 4.65625 8.67578 5.92969V18.4609C8.67578 18.7734 8.93359 19.0313 9.24609 19.0313C9.55859 19.0313 9.81641 18.7734 9.81641 18.4609V5.92969C9.81641 5.28906 10.3398 4.76562 10.9883 4.76562H29.6758C30.3164 4.76562 30.8477 5.28906 30.8477 5.92969V34.0781C30.8477 34.7188 30.3242 35.2422 29.6758 35.2422H10.9883C10.3477 35.2422 9.81641 34.7188 9.81641 34.0781V21.3828C9.81641 21.0703 9.55859 20.8125 9.24609 20.8125C8.93359 20.8125 8.67578 21.0703 8.67578 21.3828V27.1719H8.66016C8.69141 27.6953 8.71484 28.2344 8.67578 28.7656V34.0781C8.67578 35.3438 9.70703 36.3828 10.9805 36.3828H29.668C30.9414 36.3828 31.9727 35.3516 31.9727 34.0781V28.4297H32.0039C31.9961 28.0234 31.9727 27.6328 32.0039 27.2344Z" fill="#FFB114"/>
  <path d="M25.6518 20.8516C27.1284 19.2891 27.0893 16.7813 25.5659 15.2578C24.0424 13.7344 21.894 13.711 20.3159 14.8828C18.7455 13.711 16.4877 13.8438 15.0659 15.2578C13.5346 16.7891 13.5034 19.3047 14.9799 20.8516C15.0268 20.9063 14.4955 20.375 19.8784 25.75C20.0971 25.9688 20.519 25.9766 20.7455 25.75C25.6987 20.7891 25.5893 20.9141 25.644 20.8516H25.6518ZM20.3237 24.5781C19.4018 23.6563 22.6752 26.9297 15.8315 20.0781C14.7612 18.961 14.7924 17.1563 15.8862 16.0625C16.9799 14.9688 18.7846 14.9453 19.9018 16.0078C20.1284 16.25 20.5346 16.2578 20.7377 16.0078C21.8549 14.9453 23.6596 14.9688 24.7612 16.0625C25.8549 17.1563 25.8784 18.961 24.808 20.0781C24.6752 20.2188 23.0346 21.8594 20.3159 24.5781H20.3237Z" fill="#FFB114"/>
  <path d="M14.5364 11.6563L16.6146 9.57814C16.6146 9.57814 16.6302 9.56251 16.6458 9.54689C17.4114 8.75001 17.3958 7.46095 16.6067 6.6797C15.9427 6.01564 14.9114 5.90626 14.1146 6.35939C13.3255 5.89845 12.2942 6.00783 11.6224 6.6797C10.8411 7.46095 10.8255 8.75001 11.5677 9.53126C11.5833 9.54689 11.5989 9.56251 11.6224 9.58595L13.7005 11.6641C13.9036 11.8672 14.2864 11.9063 14.5286 11.6641L14.5364 11.6563ZM12.4192 8.75783C12.0833 8.39845 12.0911 7.82814 12.4349 7.47658C12.7864 7.12501 13.3646 7.12501 13.7005 7.45314C13.9193 7.68751 14.3177 7.6797 14.5364 7.45314C14.8958 7.12501 15.4583 7.13283 15.8099 7.47658C16.1614 7.82814 16.1692 8.39845 15.8255 8.75783C15.8177 8.77345 15.8255 8.75783 15.8099 8.77345L14.1224 10.461L12.4192 8.75783Z" fill="#FFB114"/>
  <path d="M26.5276 28.4688C25.7385 28.0078 24.6995 28.1172 24.0354 28.7891C23.2541 29.5703 23.2385 30.8594 23.9885 31.6485L26.1057 33.7656C26.3166 33.9766 26.6995 34 26.9338 33.7656L29.012 31.6875C29.801 30.9063 29.8166 29.586 29.012 28.7813C28.3479 28.1172 27.3245 28.0078 26.5276 28.461V28.4688ZM28.2229 30.875C28.2151 30.8906 28.2229 30.875 28.2073 30.8906L26.5198 32.5781L24.8166 30.875C24.4807 30.5156 24.4885 29.9453 24.8323 29.5938C25.1838 29.2422 25.7541 29.2344 26.1135 29.5781C26.387 29.8516 26.7385 29.7813 26.9182 29.5781C27.2776 29.2422 27.8479 29.25 28.1995 29.5938C28.551 29.9453 28.5588 30.5156 28.2151 30.875H28.2229Z" fill="#FFB114"/>
</svg>`,
    },
    {
      id: 3,
      name: "Three Card Tarot",
      svg: `<svg xmlns="http://www.w3.org/2000/svg" width="41" height="40" viewBox="0 0 41 40" fill="none">
  <path d="M32.0039 27.2344H31.9648C31.9648 27.2422 31.9648 5.92969 31.9648 5.92969C31.9648 4.66406 30.9336 3.625 29.6602 3.625H14.5586H14.582H12.5195H10.9805C9.70703 3.625 8.67578 4.65625 8.67578 5.92969V18.4609C8.67578 18.7734 8.93359 19.0313 9.24609 19.0313C9.55859 19.0313 9.81641 18.7734 9.81641 18.4609V5.92969C9.81641 5.28906 10.3398 4.76562 10.9883 4.76562H29.6758C30.3164 4.76562 30.8477 5.28906 30.8477 5.92969V34.0781C30.8477 34.7188 30.3242 35.2422 29.6758 35.2422H10.9883C10.3477 35.2422 9.81641 34.7188 9.81641 34.0781V21.3828C9.81641 21.0703 9.55859 20.8125 9.24609 20.8125C8.93359 20.8125 8.67578 21.0703 8.67578 21.3828V27.1719H8.66016C8.69141 27.6953 8.71484 28.2344 8.67578 28.7656V34.0781C8.67578 35.3438 9.70703 36.3828 10.9805 36.3828H29.668C30.9414 36.3828 31.9727 35.3516 31.9727 34.0781V28.4297H32.0039C31.9961 28.0234 31.9727 27.6328 32.0039 27.2344Z" fill="#FFB114"/>
  <path d="M25.6518 20.8516C27.1284 19.2891 27.0893 16.7813 25.5659 15.2578C24.0424 13.7344 21.894 13.711 20.3159 14.8828C18.7455 13.711 16.4877 13.8438 15.0659 15.2578C13.5346 16.7891 13.5034 19.3047 14.9799 20.8516C15.0268 20.9063 14.4955 20.375 19.8784 25.75C20.0971 25.9688 20.519 25.9766 20.7455 25.75C25.6987 20.7891 25.5893 20.9141 25.644 20.8516H25.6518ZM20.3237 24.5781C19.4018 23.6563 22.6752 26.9297 15.8315 20.0781C14.7612 18.961 14.7924 17.1563 15.8862 16.0625C16.9799 14.9688 18.7846 14.9453 19.9018 16.0078C20.1284 16.25 20.5346 16.2578 20.7377 16.0078C21.8549 14.9453 23.6596 14.9688 24.7612 16.0625C25.8549 17.1563 25.8784 18.961 24.808 20.0781C24.6752 20.2188 23.0346 21.8594 20.3159 24.5781H20.3237Z" fill="#FFB114"/>
  <path d="M14.5364 11.6563L16.6146 9.57814C16.6146 9.57814 16.6302 9.56251 16.6458 9.54689C17.4114 8.75001 17.3958 7.46095 16.6067 6.6797C15.9427 6.01564 14.9114 5.90626 14.1146 6.35939C13.3255 5.89845 12.2942 6.00783 11.6224 6.6797C10.8411 7.46095 10.8255 8.75001 11.5677 9.53126C11.5833 9.54689 11.5989 9.56251 11.6224 9.58595L13.7005 11.6641C13.9036 11.8672 14.2864 11.9063 14.5286 11.6641L14.5364 11.6563ZM12.4192 8.75783C12.0833 8.39845 12.0911 7.82814 12.4349 7.47658C12.7864 7.12501 13.3646 7.12501 13.7005 7.45314C13.9193 7.68751 14.3177 7.6797 14.5364 7.45314C14.8958 7.12501 15.4583 7.13283 15.8099 7.47658C16.1614 7.82814 16.1692 8.39845 15.8255 8.75783C15.8177 8.77345 15.8255 8.75783 15.8099 8.77345L14.1224 10.461L12.4192 8.75783Z" fill="#FFB114"/>
  <path d="M26.5276 28.4688C25.7385 28.0078 24.6995 28.1172 24.0354 28.7891C23.2541 29.5703 23.2385 30.8594 23.9885 31.6485L26.1057 33.7656C26.3166 33.9766 26.6995 34 26.9338 33.7656L29.012 31.6875C29.801 30.9063 29.8166 29.586 29.012 28.7813C28.3479 28.1172 27.3245 28.0078 26.5276 28.461V28.4688ZM28.2229 30.875C28.2151 30.8906 28.2229 30.875 28.2073 30.8906L26.5198 32.5781L24.8166 30.875C24.4807 30.5156 24.4885 29.9453 24.8323 29.5938C25.1838 29.2422 25.7541 29.2344 26.1135 29.5781C26.387 29.8516 26.7385 29.7813 26.9182 29.5781C27.2776 29.2422 27.8479 29.25 28.1995 29.5938C28.551 29.9453 28.5588 30.5156 28.2151 30.875H28.2229Z" fill="#FFB114"/>
</svg>`,
    },
    {
      id: 4,
      name: "Major Arcane",
      svg: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
  <g clip-path="url(#clip0_1313_7109)">
    <path d="M36.4916 1.20326H33.6943C33.366 1.20326 33.0998 1.46944 33.0998 1.79779C33.0998 2.12615 33.366 2.39232 33.6943 2.39232H36.4916C37.7706 2.39232 38.8111 3.43287 38.8111 4.71185V28.5241C38.8111 29.8031 37.7706 30.8437 36.4916 30.8437H20.0867C18.8077 30.8437 17.7672 29.8031 17.7672 28.5241V4.71177C17.7672 3.43279 18.8077 2.39225 20.0867 2.39225H31.7127C32.0411 2.39225 32.3072 2.12607 32.3072 1.79772C32.3072 1.46936 32.0411 1.20319 31.7127 1.20319H20.0867C18.152 1.20319 16.5781 2.77709 16.5781 4.71177V28.5241C16.5781 30.4588 18.152 32.0327 20.0867 32.0327H36.4916C38.4263 32.0327 40.0002 30.4588 40.0002 28.5241V4.71177C40.0001 2.77717 38.4262 1.20326 36.4916 1.20326Z" fill="#FFB114"/>
    <path d="M15.2413 7.96732H3.50859C1.5739 7.96732 0 9.54122 0 11.4759V27.1389C0 27.4673 0.266171 27.7334 0.59453 27.7334C0.922889 27.7334 1.18906 27.4673 1.18906 27.1389V11.4759C1.18906 10.1968 2.22961 9.15638 3.50867 9.15638H15.2414C15.5697 9.15638 15.8359 8.8902 15.8359 8.56185C15.8359 8.23349 15.5697 7.96732 15.2413 7.96732Z" fill="#FFB114"/>
    <path d="M22.8275 32.7725C22.4992 32.7725 22.233 33.0387 22.233 33.367V35.2882C22.233 36.5673 21.1925 37.6077 19.9135 37.6077H3.50859C2.22953 37.6077 1.18898 36.5671 1.18898 35.2882V29.1207C1.18898 28.7924 0.922811 28.5262 0.594452 28.5262C0.266093 28.5262 0 28.7924 0 29.1207V35.2882C0 37.2229 1.5739 38.7968 3.50859 38.7968H19.9135C21.8482 38.7968 23.4221 37.2229 23.4221 35.2882V33.367C23.4221 33.0387 23.1559 32.7725 22.8275 32.7725Z" fill="#FFB114"/>
    <path d="M33.644 16.6179L35.8058 12.8734C35.9121 12.6895 35.9121 12.4628 35.8058 12.2789C35.6996 12.095 35.5034 11.9816 35.291 11.9816H30.9671L28.8052 8.23708C28.699 8.0531 28.5028 7.93982 28.2904 7.93982C28.078 7.93982 27.8818 8.0531 27.7755 8.23708L25.6137 11.9816H21.2898C21.0774 11.9816 20.8812 12.095 20.775 12.2789C20.6688 12.4628 20.6688 12.6895 20.775 12.8734L22.9369 16.6179L20.775 20.3625C20.6688 20.5464 20.6688 20.7731 20.775 20.957C20.8812 21.1409 21.0774 21.2542 21.2898 21.2542H25.6137L27.7755 24.9988C27.8818 25.1827 28.078 25.296 28.2904 25.296C28.5027 25.296 28.699 25.1827 28.8052 24.9988L30.9671 21.2542H35.291C35.5034 21.2542 35.6996 21.1409 35.8058 20.957C35.9121 20.7731 35.9121 20.5464 35.8058 20.3625L33.644 16.6179ZM34.2614 13.1706L32.9576 15.4289L31.6537 13.1706H34.2614ZM28.2905 9.72333L29.5943 11.9816H26.9865L28.2905 9.72333ZM22.3195 13.1706H24.9273L23.6234 15.4289L22.3195 13.1706ZM22.3195 20.0652L23.6234 17.8069L24.9272 20.0652H22.3195ZM28.2905 23.5125L26.9866 21.2542H29.5944L28.2905 23.5125ZM30.2807 20.0652H26.3001L24.3098 16.6179L26.3001 13.1707H30.2807L32.271 16.6179L30.2807 20.0652ZM31.6537 20.0652L32.9575 17.8069L34.2613 20.0652H31.6537Z" fill="#FFB114"/>
    <path d="M23.9677 5.44131H23.1354V4.60896C23.1354 4.28068 22.8692 4.01443 22.5409 4.01443C22.2125 4.01443 21.9463 4.28061 21.9463 4.60896V5.44123H21.1141C20.7858 5.44123 20.5195 5.7074 20.5195 6.03576C20.5195 6.36412 20.7857 6.63029 21.1141 6.63029H21.9463V7.46255C21.9463 7.79091 22.2125 8.05708 22.5409 8.05708C22.8692 8.05708 23.1354 7.79091 23.1354 7.46255V6.63029H23.9677C24.296 6.63029 24.5622 6.36412 24.5622 6.03576C24.5622 5.7074 24.296 5.44131 23.9677 5.44131Z" fill="#FFB114"/>
    <path d="M35.4637 26.6055H34.6315V25.7732C34.6315 25.4449 34.3653 25.1787 34.0369 25.1787C33.7086 25.1787 33.4424 25.4449 33.4424 25.7732V26.6055H32.6102C32.2818 26.6055 32.0156 26.8717 32.0156 27.2C32.0156 27.5283 32.2818 27.7946 32.6102 27.7946H33.4424V28.6268C33.4424 28.9552 33.7086 29.2214 34.0369 29.2214C34.3653 29.2214 34.6315 28.9552 34.6315 28.6268V27.7946H35.4637C35.7921 27.7946 36.0583 27.5284 36.0583 27.2C36.0582 26.8717 35.792 26.6055 35.4637 26.6055Z" fill="#FFB114"/>
    <path d="M7.38952 12.2054H6.55726V11.3731C6.55726 11.0447 6.29109 10.7786 5.96273 10.7786C5.63437 10.7786 5.3682 11.0447 5.3682 11.3731V12.2054H4.53594C4.20758 12.2054 3.94141 12.4715 3.94141 12.7999C3.94141 13.1282 4.20758 13.3944 4.53594 13.3944H5.3682V14.2267C5.3682 14.555 5.63437 14.8212 5.96273 14.8212C6.29109 14.8212 6.55726 14.555 6.55726 14.2267V13.3944H7.38952C7.71788 13.3944 7.98405 13.1282 7.98405 12.7999C7.98405 12.4715 7.71788 12.2054 7.38952 12.2054Z" fill="#FFB114"/>
    <path d="M18.8856 33.3697H18.0534V32.5374C18.0534 32.209 17.7872 31.9429 17.4588 31.9429C17.1305 31.9429 16.8643 32.2091 16.8643 32.5374V33.3697H16.032C15.7037 33.3697 15.4375 33.6359 15.4375 33.9642C15.4375 34.2926 15.7037 34.5588 16.032 34.5588H16.8643V35.391C16.8643 35.7194 17.1305 35.9856 17.4588 35.9856C17.7871 35.9856 18.0534 35.7194 18.0534 35.391V34.5588H18.8856C19.214 34.5588 19.4801 34.2926 19.4801 33.9642C19.4801 33.6359 19.214 33.3697 18.8856 33.3697Z" fill="#FFB114"/>
    <path d="M15.138 28.5873C12.6824 30.2086 9.38741 29.8725 7.30328 27.7883C4.87359 25.3586 4.87359 21.4053 7.30328 18.9755C8.03249 18.2463 8.90929 17.7217 9.86069 17.4269C9.83804 17.4488 9.81561 17.4708 9.79335 17.4931C7.64148 19.645 7.64148 23.1463 9.79335 25.2982C11.3653 26.8701 13.7122 27.3459 15.7724 26.5104C16.0767 26.387 16.2233 26.0403 16.0999 25.7361C15.9765 25.4319 15.6297 25.2853 15.3255 25.4087C13.7089 26.0643 11.8675 25.6909 10.634 24.4575C8.94569 22.7693 8.94569 20.0222 10.634 18.3339C11.2 17.7679 11.9088 17.3708 12.684 17.1853C12.9637 17.1184 13.1555 16.8608 13.1393 16.5736C13.123 16.2864 12.9037 16.052 12.6181 16.0169C10.3326 15.7365 8.08874 16.5084 6.4625 18.1347C5.06094 19.5362 4.28906 21.3997 4.28906 23.3818C4.28906 25.3639 5.06094 27.2274 6.4625 28.6289C7.89249 30.0589 9.80108 30.7976 11.7216 30.7976C13.1343 30.7976 14.5536 30.3978 15.7931 29.5793C16.0672 29.3985 16.1426 29.0296 15.9616 28.7557C15.7808 28.4817 15.4119 28.4063 15.138 28.5873Z" fill="#FFB114"/>
  </g>
  <defs>
    <clipPath id="clip0_1313_7109">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>`,
    },
    {
      id: 5,
      name: "Minor Arcane",
      svg: `<svg xmlns="http://www.w3.org/2000/svg" width="41" height="40" viewBox="0 0 41 40" fill="none">
  <g clip-path="url(#clip0_1313_7139)">
    <path d="M40.2915 8.29859C39.8786 7.4832 39.173 6.87742 38.3045 6.59281L23.6303 1.78359C22.7617 1.4989 21.8344 1.56952 21.019 1.98242C20.2036 2.39523 19.5978 3.10093 19.3132 3.96945L19.1182 4.56437C18.9028 4.56874 18.6878 4.59288 18.4756 4.63804L12.4319 5.92538C12.1148 5.99288 11.9125 6.30476 11.98 6.62187C12.0388 6.89773 12.2824 7.08671 12.5536 7.08671C12.5942 7.08671 12.6353 7.08249 12.6765 7.07374L18.7175 5.78695L15.2615 16.3322L13.4159 14.2841C13.1186 13.9541 12.5581 14.0743 12.4214 14.4959L11.3574 17.7753L7.98541 18.4935C7.55213 18.5858 7.37416 19.1307 7.67166 19.4607L9.97971 22.0219L8.91572 25.3012C8.77877 25.723 9.1626 26.1491 9.59643 26.0566L12.2606 25.4891L11.746 27.059C11.4614 27.9275 11.532 28.8548 11.9449 29.6702C12.3578 30.4856 13.0634 31.0914 13.9319 31.376L22.9365 34.3271L9.61525 37.1646C8.40314 37.4229 7.20697 36.6466 6.94885 35.4346L6.12619 31.5723C6.05861 31.2552 5.74658 31.0529 5.42971 31.1204C5.1126 31.1879 4.91033 31.4998 4.97783 31.8169L5.80049 35.6792C6.1426 37.2853 7.56619 38.3884 9.14627 38.3884C9.38166 38.3884 9.62064 38.3639 9.85986 38.313L24.9631 35.0959C25.0235 35.083 25.0846 35.068 25.1461 35.0512L28.6062 36.1852C28.9588 36.3008 29.3168 36.3557 29.6693 36.3557C31.1085 36.3557 32.4513 35.4395 32.9233 33.9994L37.9498 18.6622C38.0494 18.3581 37.8788 18.0212 37.5748 17.9215C37.2707 17.8218 36.9337 17.9924 36.8341 18.2965L31.8076 33.6337C31.4216 34.8113 30.1495 35.4554 28.9719 35.0695L14.2977 30.2603C13.7271 30.0734 13.2637 29.6754 12.9924 29.1398C12.7213 28.6043 12.6749 27.9951 12.8618 27.4247L20.429 4.33515C20.616 3.7646 21.0138 3.30117 21.5495 3.02992C22.085 2.75874 22.6942 2.71242 23.2647 2.89929L37.9389 7.70851C38.5094 7.89546 38.9729 8.29343 39.2441 8.82898C39.5153 9.36452 39.5617 9.97374 39.3747 10.5441L37.5663 16.062C37.4653 16.3701 37.6332 16.7018 37.9413 16.8027C38.2492 16.9036 38.581 16.7358 38.682 16.4277L40.4904 10.9098C40.7749 10.0413 40.7043 9.11398 40.2915 8.29859ZM13.2244 15.8254L14.3979 17.1276L12.6835 17.4927L13.2244 15.8254ZM9.22447 19.43L10.939 19.0648L10.398 20.7323L9.22447 19.43ZM10.3463 24.6963L10.8872 23.029L12.0607 24.3312L10.3463 24.6963ZM11.3056 21.7394L12.265 18.7824L14.6231 18.2801L12.9071 23.5164L11.3056 21.7394Z" fill="#FFB114"/>
    <path d="M24.3019 5.47469C23.9937 5.37352 23.6622 5.54156 23.5612 5.84969L23.229 6.86328L22.2154 6.53109C21.9071 6.43008 21.5756 6.59805 21.4747 6.90609C21.3737 7.21422 21.5416 7.54586 21.8497 7.6468L22.8633 7.97898L22.5311 8.99258C22.4353 9.28484 22.5888 9.61 22.8751 9.72211C23.1851 9.84344 23.5433 9.67422 23.6468 9.35828L23.979 8.34469L24.9926 8.67687C25.3092 8.7807 25.6563 8.59141 25.7426 8.27031C25.8223 7.97344 25.6501 7.6568 25.3583 7.56117L24.3447 7.22898L24.6769 6.21539C24.7779 5.90727 24.61 5.5757 24.3019 5.47469Z" fill="#FFB114"/>
    <path d="M27.9364 32.4941C28.2406 32.5938 28.5775 32.423 28.6771 32.1191L29.0093 31.1055L30.0229 31.4377C30.3396 31.5415 30.6867 31.3521 30.7729 31.031C30.8527 30.7341 30.6804 30.4175 30.3886 30.3219L29.375 29.9897L29.7072 28.9761C29.8082 28.668 29.6403 28.3363 29.3322 28.2354C29.0239 28.1343 28.6924 28.3023 28.5915 28.6104L28.2593 29.624L27.2457 29.2918C26.9417 29.192 26.6046 29.3628 26.505 29.6668C26.4054 29.9708 26.576 30.3079 26.88 30.4075L27.8936 30.7397L27.5614 31.7533C27.4604 32.0615 27.6283 32.3931 27.9364 32.4941Z" fill="#FFB114"/>
    <path d="M28.9969 16.3639C29.866 15.9167 30.847 15.835 31.7584 16.1338L31.7943 16.1457C32.1988 16.283 32.6322 16.1382 32.8727 15.7857C33.1139 15.4321 33.0906 14.9742 32.8144 14.6466C32.0269 13.7117 30.9939 13.0155 29.827 12.6331C28.1555 12.0853 26.3667 12.2242 24.7901 13.0242C23.2134 13.8243 22.0451 15.1863 21.5002 16.859C20.3759 20.3111 22.2681 24.0395 25.7182 25.1702C26.3891 25.3901 27.0826 25.4994 27.7743 25.4994C28.6966 25.4994 29.616 25.3051 30.474 24.9196C30.8631 24.7448 31.0816 24.3438 31.0178 23.9219C30.954 23.4991 30.6261 23.18 30.202 23.1278C29.9708 23.0994 29.7403 23.0478 29.517 22.9746C27.6554 22.3645 26.6173 20.3477 27.203 18.479C27.4902 17.5624 28.1274 16.8113 28.9969 16.3639ZM29.1513 24.0902C29.183 24.1006 29.2148 24.1106 29.2466 24.1204C28.215 24.4127 27.1167 24.393 26.0839 24.0545C23.2478 23.1251 21.6924 20.0602 22.6166 17.2226C23.0642 15.8484 24.0248 14.7292 25.3214 14.0712C26.0972 13.6775 26.9352 13.4784 27.7774 13.4784C28.3427 13.4784 28.9099 13.5681 29.4614 13.7488C30.167 13.9801 30.813 14.3508 31.3627 14.8362C30.3795 14.6859 29.3722 14.8504 28.4597 15.3199C27.3087 15.9121 26.4645 16.9094 26.0826 18.1279C25.3059 20.6064 26.6825 23.2811 29.1513 24.0902Z" fill="#FFB114"/>
    <path d="M8.46615 12.434C8.39857 12.1169 8.08678 11.9145 7.76967 11.9821L6.72647 12.2043L6.50428 11.1611C6.4367 10.844 6.12498 10.6416 5.80779 10.7092C5.49068 10.7767 5.28842 11.0886 5.35592 11.4057L5.57811 12.4489L4.53482 12.6711C4.22623 12.7368 4.02045 13.047 4.08084 13.3568C4.14279 13.6748 4.46193 13.8871 4.77943 13.8195L5.82272 13.5973L6.0449 14.6406C6.1124 14.9574 6.43647 15.1637 6.75209 15.0899C7.05943 15.0181 7.25904 14.705 7.19326 14.396L6.97107 13.3527L8.01428 13.1305C8.33139 13.063 8.53365 12.7511 8.46615 12.434Z" fill="#FFB114"/>
    <path d="M5.2216 30.1357C5.53871 30.0682 5.74105 29.7563 5.67347 29.4392L1.88863 11.6698C1.63043 10.4577 2.40652 9.26157 3.61863 9.00337L10.3729 7.5647C10.69 7.49712 10.8924 7.18532 10.8248 6.86822C10.7572 6.55111 10.4454 6.34853 10.1283 6.41634L3.37402 7.85501C2.48011 8.0454 1.71386 8.57251 1.21644 9.33923C0.719019 10.1059 0.549879 11.0205 0.740269 11.9144L4.52519 29.6838C4.59183 29.9967 4.90863 30.2024 5.2216 30.1357Z" fill="#FFB114"/>
  </g>
  <defs>
    <clipPath id="clip0_1313_7139">
      <rect width="40" height="40" fill="white" transform="translate(0.664062)"/>
    </clipPath>
  </defs>
</svg>`,
    },
  ];

  horoscope: {
    name: TZodiacSign,
  } = {
    name: 'Aries',
  }

  horoscopeSvg!: SafeHtml;

  constructor(private headerService: HeaderService, private route: ActivatedRoute, private router: Router, private sanitizer: DomSanitizer, private zodiacService: ZodiacServices, private themeService: ThemeService) {}

  ngOnInit(): void {
    this.loadSvgColor();
    this.headerService.setColorSubject(true);
    this.headerService.setNavSubject('Tarot Reading');
    this.route.paramMap.subscribe(params => {
      this.setSelectedOption(params);
      this.setAllSvg();
    });
  }

  private loadSvgColor() {
    this.svgColor = this.themeService.getSvgColor();
  }

  private setSelectedOption(params: ParamMap){
    const option = parseInt(params.get('option') || '0', 10);
    if ([1, 3, 4, 5].includes(option as TSelectedOption)) {
      this.selectedOption = option as TSelectedOption;
    }
  }

  private safeSVGMaker(svg: string): SafeHtml {
    return this.sanitizer.bypassSecurityTrustHtml(svg);
  }

  private getHoroscopeSVG() {
    const svg = this.zodiacService.getSvg(this.horoscope.name);
    const newSVG = this.changeSize(svg);
    console.log("fired2")
    this.horoscopeSvg = this.safeSVGMaker(newSVG);
  }

  private changeSize(svgString: string){
    
    const colorSvg = this.changeSvg(svgString);

    const newHSVG = colorSvg.replace(
      /(<svg[^>]+)(height="[^"]*")/g, 
      (match, p1) => `${p1} height="${'16px'}"`
    );

    return newHSVG.replace(
      /(<svg[^>]+)(width="[^"]*")/g, 
      (match, p1) => `${p1} width="${'22px'}"`
    );
  }

  private changeSvg(svg: string): string {
    let targets: Array<'primary' | 'secondary' | 'tertiary' | 'stroke'> = ['primary','secondary', 'tertiary' , 'stroke']
    targets.forEach(t => {
      svg = svg?.replace(new RegExp(t,"g"),this.svgColor[t]) || '';
    });
    return svg;
  }

  private setAllSvg() {
    console.log("fired")
    this.readingOptions.forEach(c => {
      c.svg = this.safeSVGMaker(c.svg as string);
    });
    this.summaryCard.svg = this.safeSVGMaker(this.summaryCard.svg as string);
    this.getHoroscopeSVG();
  }

  selectOption(i: TSelectedOption) {
    this.router.navigate(['home/tarot/o', i]);
  }

}
